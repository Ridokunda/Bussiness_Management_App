<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeFixIt | <%= title %></title>
    <link rel="stylesheet" href="/stylesheets/style.css">
</head>
<body>
    <div class="bookings-container">
        <h2>Bookings Page</h2>
        <div class="container-bookings-tables">
            <% bookings.forEach(booking =>{ %>
                <div class="booking-entry">
                    <table class="booking-table">
                        <thead>
                            <tr>
                                <th>Customer Name</th>
                                <th>Service type</th>
                                <th>Date Available</th>
                                <th>Description</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span>Ridokunda</span></td>
                                <td><span><%= booking.type %></span></td>
                                <td><span>10 Feb 2024</span></td>
                                <td><span>I want full plumbing for two bathrooms</span></td>
                                <td><button type="button" class="btn-assign" data-booking-id="<%= booking.idbookings %>">Assign plumber</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="assign-container" id="assign-container-<%= booking.idbookings %>">
                        <div class="popup">
                            <span class="close">&times;</span>
                            <h3>Available Plumbers</h3>
                            <table class="plumbers-table">
                                <thead>
                                    <tr>
                                        <th>Plumber Name</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <a href="" style="text-decoration: none; color: inherit;">
                                        <tr>
                                            <td>Kundi netshi</td>
                                            <td>Available</td>
                                        </tr>
                                    </a>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>
   <script>
        const buttons = document.querySelectorAll('.btn-assign');

        buttons.forEach(button => {
            button.addEventListener('click', (event) => {
                console.log('Button clicked');
                const bookingId = event.target.getAttribute('data-booking-id');
                const popup = document.getElementById(`assign-container-${bookingId}`);
                popup.style.display = 'block';
            });
        });

        document.querySelectorAll('.close').forEach(span => {
            span.addEventListener('click', (event) => {
                console.log('Close button clicked');
                const popup = event.target.closest('.assign-container');
                popup.style.display = 'none';
            });
        });

        window.addEventListener('click', (event) => {
            if (event.target.classList.contains('assign-container')) {
                console.log('Outside popup clicked');
                event.target.style.display = 'none';
            }
        });
   </script>
</body>
</html>
